<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Inscription - Hockey Club de Savenay</title>
  <link rel="stylesheet" href="style1.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="logo.png" alt="Logo Hockey Club de Savenay" class="logo">
		<h1>Formulaire d'inscription<BR>Hockey Club de Savenay (2025/2026)</h1>
    </div>

<!-- Sélecteur adulte/enfant -->
<div class="form-selector">
  <label><input type="radio" name="formChoice" value="adulte" checked> Formulaire adulte</label>
  <label><input type="radio" name="formChoice" value="enfant"> Formulaire enfant</label>
</div>

    <p class="intro">Ce formulaire est rempli et converti en PDF uniquement dans votre navigateur — aucune donnée n'est envoyée.</p>

    <!-- ================= FORMULAIRE ADULTE ================= -->
    <div id="form-adulte" class="form-block">
      <div class="block">
        <h2>Identité</h2>
        <div class="grid">
          <div><label>Nom<input type="text" id="nom_adulte"></label></div>
          <div><label>Prénom<input type="text" id="prenom_adulte"></label></div>
          <div><label>Date de naissance<input type="date"></label></div>
          <div><label>Sexe<select><option>-</option><option>Homme</option><option>Femme</option></select></label></div>
          <div class="full"><label>Adresse<input type="text"></label></div>
          <div><label>Code Postal<input type="text"></label></div>
          <div><label>Ville<input type="text"></label></div>
          <div><label>Email<input type="email"></label></div>
          <div><label>Téléphone<input type="tel"></label></div>
        </div>
      </div>

<!-- Consentements -->
<div class="block-consents">
  <h2>Consentements</h2>

  <div class="consent-item">
    <label class="consent-row">
      <input type="checkbox" id="donnees" name="donnees">
      <div class="consent-text">
        <strong>Données personnelles</strong>
        <p>En cochant cette case et en soumettant ce formulaire, j'accepte que les informations saisies
        soient utilisées par le Hockey Club de Savenay pour me recontacter…</p>
      </div>
    </label>
  </div>

  <div class="consent-item">
    <label class="consent-row">
      <input type="checkbox" id="charte" name="charte">
      <div class="consent-text">
        <strong>Charte du club</strong>
        <p>En cochant cette case, je déclare avoir lu la charte du Club et m’engage à la respecter.</p>
      </div>
    </label>
  </div>

  <div class="consent-item">
    <label class="consent-row">
      <input type="checkbox" id="droit_image" name="droit_image">
      <div class="consent-text">
        <strong>Droit à l’image</strong>
        <p>Pour les saisons sportives où je suis licencié au club, j’autorise le Hockey Club de Savenay
        à utiliser les photographies/vidéos prises dans le cadre associatif.</p>
      </div>
    </label>
  </div>
</div>

<!-- Questionnaire de santé -->
      <div class="block">
        <h2>Questionnaire santé adulte (pour un renouvellement de licence)</h2>
		  <h3>Pour une nouvelle inscription, le certificat médical est obligatoire</h3>
        <table class="health-table">
          <thead><tr><th>Question</th><th>OUI</th><th>NON</th></tr></thead>
          <tbody>
            <tr><td>Avez-vous été hospitalisé ou opéré ?</td><td><input type="radio" name="qa1" value="oui"></td><td><input type="radio" name="qa1" value="non"></td></tr>
            <tr><td>Avez-vous eu des malaises ou pertes de connaissance ?</td><td><input type="radio" name="qa2" value="oui"></td><td><input type="radio" name="qa2" value="non"></td></tr>
            <tr><td>Avez-vous ressenti une douleur dans la poitrine ou des palpitations ?</td><td><input type="radio" name="qa3" value="oui"></td><td><input type="radio" name="qa3" value="non"></td></tr>
            <tr><td>Avez-vous un traitement quotidien au long cours ?</td><td><input type="radio" name="qa4" value="oui"></td><td><input type="radio" name="qa4" value="non"></td></tr>
            <tr><td>Avez-vous arrêté le sport suite à un problème de santé ?</td><td><input type="radio" name="qa5" value="oui"></td><td><input type="radio" name="qa5" value="non"></td></tr>
          </tbody>
        </table>
        <div class="info-box">
          Si vous avez répondu NON à toutes les questions → pas besoin de certificat médical.<br>
          Si vous avez répondu OUI à une ou plusieurs → certificat médical obligatoire.
        </div>
      </div>

      <div class="block">
        <h2>Signature</h2>
        <canvas id="signatureAdulte" width="400" height="150"></canvas>
        <button type="button" onclick="clearSignature('signatureAdulte')">Effacer</button>
      </div>
      <div class="buttons">
      <button class="btn-primary" type="button" onclick="generatePDF()">Générer PDF</button>
      <button class="btn-secondary" type="button" onclick="resetForm()">Réinitialiser</button>
    </div>
	</div>
    <!-- ================= FORMULAIRE ENFANT ================= -->
    <div id="form-enfant" class="form-block hidden">
      <div class="block">
        <h2>Identité enfant</h2>
        <div class="grid">
          <div><label>Nom<input type="text" id="nom_enfant"></label></div>
          <div><label>Prénom<input type="text" id="prenom_enfant"></label></div>
          <div><label>Date de naissance<input type="date"></label></div>
          <div><label>Sexe<select><option>-</option><option>Fille</option><option>Garçon</option></select></label></div>
          <div class="full"><label>Adresse<input type="text"></label></div>
          <div><label>Code Postal<input type="text"></label></div>
          <div><label>Ville<input type="text"></label></div>
        </div>
      </div>

      <div class="block">
        <h2>Responsable légal 1</h2>
        <div class="grid">
          <div><label>Nom<input type="text"></label></div>
          <div><label>Prénom<input type="text"></label></div>
          <div class="full"><label>Email<input type="email"></label></div>
          <div><label>Téléphone<input type="tel"></label></div>
        </div>
      </div>
	  
      <div class="block">
        <h2>Responsable légal 2</h2>
        <div class="grid">
          <div><label>Nom<input type="text"></label></div>
          <div><label>Prénom<input type="text"></label></div>
          <div class="full"><label>Email<input type="email"></label></div>
          <div><label>Téléphone<input type="tel"></label></div>
        </div>
      </div>	  

<div class="block-consents">
  <h2>Consentements</h2>

  <div class="consent-item">
    <label class="consent-row">
      <input type="checkbox" name="donnees_enfant">
      <div class="consent-text">
        <strong>Données personnelles</strong>
        <p>J’accepte que les informations saisies soient utilisées uniquement pour l’inscription.</p>
      </div>
    </label>
  </div>

  <div class="consent-item">
    <label class="consent-row">
      <input type="checkbox" name="charte_enfant">
      <div class="consent-text">
        <strong>Charte du club</strong>
        <p>Je déclare avoir lu la charte du club et m’engage à la respecter.</p>
      </div>
    </label>
  </div>

  <div class="consent-item">
    <label class="consent-row">
      <input type="checkbox" name="transport_enfant">
      <div class="consent-text">
        <strong>Transport</strong>
        <p>J’autorise le transport de mon enfant par un responsable du club en cas de besoin.</p>
      </div>
    </label>
  </div>

  <div class="consent-item">
    <label class="consent-row">
      <input type="checkbox" name="image_enfant">
      <div class="consent-text">
        <strong>Droit à l’image</strong>
        <p>J’autorise l’utilisation des photos/vidéos prises dans le cadre du club.</p>
      </div>
    </label>
  </div>
</div>


      <div id="autorisation-urgence" class="block">
  <h3>Autorisation urgence/accident</h3>
  <p>
    Je soussigné(e) M, Mme 
    <input type="text" name="responsable_nom" style="width: 250px;">
    , responsable légal(e) de l'enfant 
    <input type="text" name="enfant_nom" style="width: 200px;">
    , en catégorie 
    <select name="categorie" style="width: 120px; display: inline-block;">
           <option value="-">-</option>
		   <option value="baby">Baby</option>
           <option value="U8">U8</option>
		   <option value="U8">U10</option>
		   <option value="U8">U12</option>
		   <option value="U8">U14</option>
         </select>
    ,<BR>autorise les responsables du club à prendre toutes mesures d'urgence nécessaires en cas d'accident.
  </p>
</div>

       <!-- Questionnaire santé enfant -->
      <div class="form-section">
        <h3>Questionnaire de santé</h3>
        <p>
         Tu es : 
         <select name="genre" style="width: 120px; display: inline-block;">
           <option value="-">-</option>
		   <option value="fille">Fille</option>
           <option value="garcon">Garçon</option>
         </select>
        </p>
         <p><b>Ton âge :</b> <input type="number" style="width:80px;"> ans</p>

        <table class="health-table">
          <thead><tr class="section-title"><th>#</th><th>Depuis l’an dernier :</th><th>OUI</th><th>NON</th></tr></thead>
          <tbody>
            <tr><td>1</td><td>Es tu allé(e) à l'hopital toute une journée ou plusieurs jours?</td><td><input type="radio" name="eq1" value="oui"></td><td><input type="radio" name="eq1" value="non"></td></tr>
            <tr><td>2</td><td>As tu été opéré?</td><td><input type="radio" name="eq2" value="oui"></td><td><input type="radio" name="eq2" value="non"></td></tr>
            <tr><td>3</td><td>As tu beaucoup plus grandi que les autres années?</td><td><input type="radio" name="eq3" value="oui"></td><td><input type="radio" name="eq3" value="non"></td></tr>
            <tr><td>4</td><td>As tu beaucoup maigri ou grossi?</td><td><input type="radio" name="eq4" value="oui"></td><td><input type="radio" name="eq4" value="non"></td></tr>
            <tr><td>5</td><td>As tu eu la tête qui tourne pendant un effort?</td><td><input type="radio" name="eq5" value="oui"></td><td><input type="radio" name="eq5" value="non"></td></tr>
            <tr><td>6</td><td>As tu perdu connaissance ou es tu tombé sans te souvenir de ce qui s'était passé?</td><td><input type="radio" name="eq6" value="oui"></td><td><input type="radio" name="eq6" value="non"></td></tr>
            <tr><td>7</td><td>As tu reçu un ou plusieurs chocs violents qui t'ont obligé à interrompre un moment une séance de sport?</td><td><input type="radio" name="eq7" value="oui"></td><td><input type="radio" name="eq7" value="non"></td></tr>
            <tr><td>8</td><td>As tu eu beaucoup de mal à respirer pendant un effort par rapport à d'habitude?</td><td><input type="radio" name="eq8" value="oui"></td><td><input type="radio" name="eq8" value="non"></td></tr>
            <tr><td>9</td><td>As tu eu beaucoup de mal à respirer après un effort?</td><td><input type="radio" name="eq9" value="oui"></td><td><input type="radio" name="eq9" value="non"></td></tr>
            <tr><td>10</td><td>As tu eu mal dans la poitrine ou des palpitations (le coeur qui bat très vite)?</td><td><input type="radio" name="eq10" value="oui"></td><td><input type="radio" name="eq10" value="non"></td></tr>
            <tr><td>11</td><td>As tu commencé à prendre un nouveau médicament tous les jours et pour longtemps?</td><td><input type="radio" name="eq11" value="oui"></td><td><input type="radio" name="eq11" value="non"></td></tr>
            <tr><td>12</td><td>As tu arrêté le sport à cause d'un problème de santé pendant un mois ou plus?</td><td><input type="radio" name="eq12" value="oui"></td><td><input type="radio" name="eq12" value="non"></td></tr>
          </tbody>

          <thead><tr class="section-title"><th>#</th><th>Depuis un certain temps (plus de 2 semaines) :</th><th>OUI</th><th>NON</th></tr></thead>
          <tbody>
            <tr><td>13</td><td>Te sens tu très fatigué(e)?</td><td><input type="radio" name="eq13" value="oui"></td><td><input type="radio" name="eq13" value="non"></td></tr>
            <tr><td>14</td><td>As tu du mal à t'endormir ou te réveilles tu souvent dans la nuit?</td><td><input type="radio" name="eq14" value="oui"></td><td><input type="radio" name="eq14" value="non"></td></tr>
            <tr><td>15</td><td>Sens tu que tu as moins faim? que tu manges moins?</td><td><input type="radio" name="eq15" value="oui"></td><td><input type="radio" name="eq15" value="non"></td></tr>
            <tr><td>16</td><td>Te sens tu triste ou inquiet?</td><td><input type="radio" name="eq16" value="oui"></td><td><input type="radio" name="eq16" value="non"></td></tr>
            <tr><td>17</td><td>Pleures tu plus souvent?</td><td><input type="radio" name="eq17" value="oui"></td><td><input type="radio" name="eq17" value="non"></td></tr>
            <tr><td>18</td><td>Ressens tu une douleur ou un manque de force à cause d'une blessure que tu t'es fait cette année?</td><td><input type="radio" name="eq18" value="oui"></td><td><input type="radio" name="eq18" value="non"></td></tr>
          </tbody>

          <thead><tr class="section-title"><th>#</th><th>Aujourd’hui :</th><th>OUI</th><th>NON</th></tr></thead>
          <tbody>
            <tr><td>19</td><td>Penses tu quelquefois à arrêter de faire du sport ou à changer de sport?</td><td><input type="radio" name="eq19" value="oui"></td><td><input type="radio" name="eq19" value="non"></td></tr>
            <tr><td>20</td><td>Penses tu avoir besoin de voir ton médecin pour continuer le sport?</td><td><input type="radio" name="eq20" value="oui"></td><td><input type="radio" name="eq20" value="non"></td></tr>
            <tr><td>21</td><td>Souhaites tu signaler quelque chose de plus concernant ta santé?</td><td><input type="radio" name="eq21" value="oui"></td><td><input type="radio" name="eq21" value="non"></td></tr>
          </tbody>

          <thead><tr class="section-title"><th>#</th><th>Questions à faire remplir par tes parents :</th><th>OUI</th><th>NON</th></tr></thead>
          <tbody>
            <tr><td>22</td><td>Quelqu'un dans votre famille proche a t'il eu une maladie grave du coeur ou du cerveau, ou est il décédé subitement avant l'âge de 50 ans?</td><td><input type="radio" name="eq22" value="oui"></td><td><input type="radio" name="eq22" value="non"></td></tr>
            <tr><td>23</td><td>Etes vous inquiet pour son poids? Trouvez vous qu'il se nourrit trop ou pas assez?</td><td><input type="radio" name="eq23" value="oui"></td><td><input type="radio" name="eq23" value="non"></td></tr>
            <tr><td>24</td><td>Avez vous manqué l'examen de santé prévu à l'âge de votre enfant chez le médecin? (2ans, 3ans, 4ans, 5ans, entre 8 et 9ans, entre 11 et 13ans et entre 15 et 16ans.)</td><td><input type="radio" name="eq24" value="oui"></td><td><input type="radio" name="eq24" value="non"></td></tr>
          </tbody>
        </table>

        <div class="info-box">
          <b>Si tu as répondu NON à toutes les questions :</b> Pas de certificat médical à fournir.
        </div>
        <div class="info-box">
          <b>Si tu as répondu OUI à une ou plusieurs questions :</b> Tu dois consulter un médecin pour qu'il t'examine et discute avec toi du sport qui te convient. Apporte-lui ce questionnaire rempli.
        </div>
      </div>

      <div class="block">
  <h2>Signatures</h2>
  <div class="signatures-row">
    
    <div class="signature-col">
      <p>Signature de l'enfant :</p>
      <canvas id="signatureEnfant" width="300" height="120"></canvas>
      <button type="button" onclick="clearSignature('signatureEnfant')">Effacer</button>
    </div>

    <div class="signature-col">
      <p>Signature du responsable légal :</p>
      <canvas id="signatureRL" width="300" height="120"></canvas>
      <button type="button" onclick="clearSignature('signatureRL')">Effacer</button>
    </div>

  </div>
</div>

    <div class="buttons">
    <button class="btn-primary" type="button" onclick="generatePDF()">Générer PDF</button>
    <button class="btn-secondary" type="button" onclick="resetForm()">Réinitialiser</button>
    </div>
  </div>

<script>
  // Toggle form visibility
  document.querySelectorAll('input[name="formChoice"]').forEach(radio => {
    radio.addEventListener('change', () => {
      document.getElementById('form-adulte').classList.toggle('hidden', radio.value !== 'adulte' || !radio.checked);
      document.getElementById('form-enfant').classList.toggle('hidden', radio.value !== 'enfant' || !radio.checked);
    });
  });

  // Signature handling (simple)
  function initCanvas(id) {
    const canvas = document.getElementById(id);
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    let drawing = false;
    ctx.lineWidth = 2;
    ctx.lineCap = 'round';
    ctx.strokeStyle = "#000";
    let lastX = 0, lastY = 0;

    canvas.addEventListener('mousedown', (e) => {
      drawing = true;
      [lastX, lastY] = [e.offsetX, e.offsetY];
    });
    canvas.addEventListener('mouseup', () => drawing = false);
    canvas.addEventListener('mousemove', (e) => {
      if (!drawing) return;
      ctx.beginPath();
      ctx.moveTo(lastX, lastY);
      ctx.lineTo(e.offsetX, e.offsetY);
      ctx.stroke();
      [lastX, lastY] = [e.offsetX, e.offsetY];
    });
  }
  ['signatureAdulte','signatureEnfant','signatureRL'].forEach(initCanvas);

  function clearSignature(id) {
    const canvas = document.getElementById(id);
    if (canvas) canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);
  }

  // Utilitaire : capture un élément (clone) et l'ajoute au PDF, en remplaçant les canvas par des images
  async function addBlockToPDF(element, pdfPage, pageWidth, pageHeight, margin = 10, yOffset = 35, centerVertically = false) {
    const clone = element.cloneNode(true);

    // Remplacer les canvas par des images
    const canvasesInClone = clone.querySelectorAll('canvas');
    canvasesInClone.forEach(canvasClone => {
        const id = canvasClone.id;
        let replaced = false;
        if (id) {
            const original = document.getElementById(id);
            if (original && typeof original.toDataURL === 'function') {
                const img = document.createElement('img');
                img.src = original.toDataURL("image/png");
                if (canvasClone.width) img.width = canvasClone.width;
                if (canvasClone.height) img.height = canvasClone.height;
                img.style.display = 'block';
                canvasClone.parentNode.replaceChild(img, canvasClone);
                replaced = true;
            }
        }
        if (!replaced) {
            const spacer = document.createElement('div');
            spacer.style.width = (canvasClone.width ? canvasClone.width + 'px' : '300px');
            spacer.style.height = (canvasClone.height ? canvasClone.height + 'px' : '120px');
            canvasClone.parentNode.replaceChild(spacer, canvasClone);
        }
    });

    // Wrapper hors écran
    const wrapper = document.createElement('div');
    wrapper.style.position = 'absolute';
    wrapper.style.left = '-9999px';
    wrapper.style.top = '0px';
    wrapper.appendChild(clone);
    document.body.appendChild(wrapper);

    const canvas = await html2canvas(wrapper, { scale: 2, useCORS: true, backgroundColor: "#ffffff" });
    document.body.removeChild(wrapper);

    const imgData = canvas.toDataURL("image/png");
    let imgWidthMm = pageWidth - margin * 2;
    const mmPerPx = imgWidthMm / canvas.width;
    let imgHeightMm = canvas.height * mmPerPx;

    const availableHeight = pageHeight - margin * 2;
    let drawWidth = imgWidthMm;
    let drawHeight = imgHeightMm;

    if (drawHeight > availableHeight) {
        const ratio = availableHeight / drawHeight;
        drawHeight = availableHeight;
        drawWidth = imgWidthMm * ratio;
    }
	
    // après calcul de drawWidth et drawHeight
    const scaleFactor = 0.90; // 95% de taille
    drawWidth *= scaleFactor;
    drawHeight *= scaleFactor;
	
    // Centrage vertical si demandé
    let yPos = yOffset;
    if (centerVertically) {
        yPos = (pageHeight - drawHeight) / 2;
    }

    const xPos = margin + (imgWidthMm - drawWidth) / 2;
    pdfPage.addImage(imgData, "PNG", xPos, yPos, drawWidth, drawHeight);
}


  // Génération PDF principal (1 fonction pour adulte/enfant)
  async function generatePDF() {
    try {
      console.log("generatePDF démarré");
      const { jsPDF } = window.jspdf;
      if (!jsPDF) throw new Error("jsPDF introuvable");

      const selected = document.querySelector('input[name="formChoice"]:checked');
      if (!selected) {
        alert("Veuillez choisir adulte ou enfant.");
        return;
      }
      const choice = selected.value;
      const pdf = new jsPDF("p", "mm", "a4");
      const margin = 10;
      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();

      // Header (logo + titre)
      async function addHeader(page) {
        const logo = document.querySelector(".logo");
        if (logo && logo.src) {
          let imgData = logo.src;
          if (!imgData.startsWith("data:")) {
            try {
              const resp = await fetch(logo.src);
              const blob = await resp.blob();
              imgData = await new Promise((resolve) => {
                const r = new FileReader();
                r.onload = () => resolve(r.result);
                r.readAsDataURL(blob);
              });
            } catch (e) {
              console.warn("Impossible de fetch le logo, on skip :", e);
              imgData = null;
            }
          }
          if (imgData) page.addImage(imgData, "PNG", margin, 6, 42, 25);
        }
		const textCenter = pageWidth / 2;
        page.setFontSize(16);
		page.setFont("helvetica", "bold");
        page.setTextColor(233, 30, 99);
        page.text("Formulaire d'inscription", textCenter +10, 20, { align: "center" });
		page.text("Hockey Club de Savenay (2025/2026)", textCenter +10, 28, { align: "center" });
      }

      if (choice === "adulte") {
        // adulte = 1 page (on inclut la signatureAdulte via addBlockToPDF)
        await addHeader(pdf);
        const form = document.getElementById("form-adulte");
        if (!form) throw new Error("form-adulte introuvable");
        // supprimer boutons clonés sera fait dans addBlockToPDF (clone isolé)
        await addBlockToPDF(form, pdf, pageWidth, pageHeight, margin, 30);

} else {
    // enfant : PAGE 1 = jusqu'au formulaire enfant avant consentements
    const form = document.getElementById("form-enfant");
    if (!form) throw new Error("form-enfant introuvable");

    const children = Array.from(form.children);
    const idxConsents = children.findIndex(el => el.classList && el.classList.contains("block-consents"));
    
    // PARTIE 1 = tous les blocs avant le consentement
    const part1 = document.createElement('div');
    children.slice(0, idxConsents).forEach(el => part1.appendChild(el.cloneNode(true)));

    await addHeader(pdf);
    await addBlockToPDF(part1, pdf, pageWidth, pageHeight, margin, 30, false, 0.90);

    // PAGE 2 = consentements + autorisation + questionnaire santé + signatures
    pdf.addPage();

    const part2 = document.createElement('div');

    // Consentements
    if (idxConsents >= 0) part2.appendChild(children[idxConsents].cloneNode(true));

    // Autorisation urgence/accident
    const autorisation = form.querySelector('#autorisation-urgence');
    if (autorisation) part2.appendChild(autorisation.cloneNode(true));

    // Questionnaire santé
    const healthTable = form.querySelector('.health-table');
    let healthSection = null;
    if (healthTable) {
        healthSection = healthTable.closest('.form-section, .block') || healthTable.parentNode;
    }
    if (healthSection) part2.appendChild(healthSection.cloneNode(true));

    // Signatures
    const signaturesBlock = form.querySelector('.signatures-row')?.closest('.block') 
                          || form.querySelector('.signatures-row')?.parentNode;
    if (signaturesBlock) part2.appendChild(signaturesBlock.cloneNode(true));

    await addBlockToPDF(part2, pdf, pageWidth, pageHeight, margin, 0, true);
}

      // Nom fichier à partir des 2 premiers inputs text du formulaire choisi
      const refForm = document.getElementById(choice === "adulte" ? "form-adulte" : "form-enfant");
      const allTextInputs = Array.from(refForm.querySelectorAll('input[type="text"]'));
      const nom = (allTextInputs[0]?.value || "nom").trim().replace(/\s+/g, "_");
      const prenom = (allTextInputs[1]?.value || "prenom").trim().replace(/\s+/g, "_");
      const filename = `inscription_hockey_${choice}_${nom}_${prenom}.pdf`;
      pdf.save(filename);
      console.log("PDF sauvegardé :", filename);
    } catch (err) {
      console.error("Erreur génération PDF :", err);
      alert("Erreur lors de la génération du PDF — ouvre la console (F12) pour voir l'erreur complète.");
    }
  }

  // Reset formulaire
  function resetForm() {
    document.querySelectorAll('input').forEach(input => {
      if (input.type === 'checkbox' || input.type === 'radio') input.checked = false;
      else input.value = '';
    });
    ['signatureAdulte','signatureEnfant','signatureRL'].forEach(clearSignature);
  }
</script>
</body>
</html>





